<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>–ö–∞–∑–∏–Ω–æ</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/supabase.min.js"></script>
<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    min-height: 100vh; 
    color: #fff;
    background-image: url("avatarki/2313.png");
    background-repeat: no-repeat;
    background-position: center;
    background-size: cover;
    padding-bottom: 80px;
}
.content_slot {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2vw;
    position: relative;
    z-index: 1;
    margin: 10px 0;
}
.buttons-container, .buttons-container2, .buttons-container3, .buttons-container4, .buttons-container5 {
    display: flex;
    justify-content: center;
    gap: 20px; 
    padding: 20px 0;
    margin-top: 50px;
}
.image-button {
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
}
.image-button img {
    width: 30vw;
    max-width: 250px;
    height: auto;
    border-radius: 15px;
}
@media (max-width: 400px) {
    .image-button img {
        width: 35vw;
    }
}
.bottom-nav {
    position: fixed;
    bottom: 0;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 10px 0;
    z-index: 999;
    gap: 75px;
}
.bottom-nav button {
    background-color: #610000;
    color: #fff;
    border: none;
    padding: 12px 24px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1.2em;
    transition: background-color 0.3s;
}
.bottom-nav button:hover {
    background-color: #610000a4;
}
#betContainer {
    display: none;
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.8);
    align-items: center;
    justify-content: center;
    flex-direction: column;
    z-index: 9999;
}
#betBox {
    background: #000;
    padding: 20px;
    border-radius: 10px;
    text-align: center;
    max-width: 300px;
    width: 80%;
}
#betBox h2 {
    color: #0ff;
    margin-bottom: 15px;
}
#betInput {
    font-size: 1.5em;
    padding: 10px;
    border-radius: 5px;
    border: none;
    width: 200px;
    text-align: center;
    margin-bottom: 15px;
}
#startGameBtn {
    padding: 10px 20px;
    font-size: 1.2em;
    border: none;
    border-radius: 5px;
    background: #0ff;
    color: #000;
    cursor: pointer;
}
#startGameBtn:hover {
    background: #00cccc;
}
</style>
</head>
<body>

<!-- –í–∞—à–∏ –∫–Ω–æ–ø–∫–∏ -->
<div class="buttons-container">
    <div class="content_slot"><button class="image-button" id="gameButton"><img src="avatarki/piramida.jpg" alt="–ü–µ—Ä–µ–π—Ç–∏" /></button></div>
    <div class="content_slot"><button class="image-button" id="gameButton2"><img src="avatarki/saper.jpg" alt="–ü–µ—Ä–µ–π—Ç–∏" /></button></div>
</div>
<div class="buttons-container2">
    <div class="content_slot"><button class="image-button" id="gameButton3"><img src="avatarki/kubiki.jpg" alt="–ü–µ—Ä–µ–π—Ç–∏" /></button></div>
    <div class="content_slot"><button class="image-button" id="gameButton4"><img src="avatarki/bingo.jpg" alt="–ü–µ—Ä–µ–π—Ç–∏" /></button></div>
</div>
<div class="buttons-container3">
    <div class="content_slot"><button class="image-button" id="gameButton5"><img src="avatarki/flappybird.jpg" alt="–ü–µ—Ä–µ–π—Ç–∏" /></button></div>
    <div class="content_slot"><button class="image-button" id="gameButton6"><img src="avatarki/blackjack.jpg" alt="–ü–µ—Ä–µ–π—Ç–∏" /></button></div>
</div>
<div class="buttons-container4">
    <div class="content_slot"><button class="image-button" id="gameButton7"><img src="avatarki/loterea.jpg" alt="–ü–µ—Ä–µ–π—Ç–∏" /></button></div>
    <div class="content_slot"><button class="image-button" id="gameButton8"><img src="avatarki/roolet.jpg" alt="–ü–µ—Ä–µ–π—Ç–∏" /></button></div>
</div>
<div class="buttons-container5">
    <div class="content_slot"><button class="image-button" id="gameButton9"><img src="avatarki/krestikinoliki.jpg" alt="–ü–µ—Ä–µ–π—Ç–∏" /></button></div>
    <div class="content_slot"><button class="image-button" id="gameButton10"><img src="avatarki/molnya.jpg" alt="–ü–µ—Ä–µ–π—Ç–∏" /></button></div>
</div>

<!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
<div class="bottom-nav">
    <button onclick="window.location.href='https://jdfhg321.github.io/gfdjfgk/'">–ò–≥—Ä—ã</button>
    <button id="profileButton">–ü—Ä–æ—Ñ–∏–ª—å</button>
</div>

<!-- –û–∫–Ω–æ —Å—Ç–∞–≤–∫–∏ -->
<div id="betContainer">
<div id="betBox">
    <h2>–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É —Å—Ç–∞–≤–∫–∏</h2>
    <input type="number" id="betInput" />
    <br/>
    <button id="startGameBtn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
</div>
</div>

<script>
(async () => {
    const tg = window.Telegram.WebApp;
    tg.ready();

    let userId = null;
    let nickname = null;
    let balance = null;

    // –ü–æ–ª—É—á–∞–µ–º userId –∏–∑ URL –∏–ª–∏ tg.initDataUnsafe
    const urlParams = new URLSearchParams(window.location.search);
    userId = urlParams.get('id');

    if (!userId && tg.initDataUnsafe?.user) {
        userId = tg.initDataUnsafe.user.id;
    }

    // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è
    async function loadProfile() {
        if (userId) {
            // –û–±–Ω–æ–≤–ª—è–µ–º ID
            document.querySelector('#id div:nth-child(2)').textContent = 'ID TG: ' + userId;

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –±–∞–ª–∞–Ω—Å –∏ –Ω–∏–∫–Ω–µ–π–º
            try {
                const response = await supabaseClient
                    .from('users')
                    .select('balance,nickname')
                    .eq('id', userId)
                    .single();

                if (!response.error && response.data) {
                    nickname = response.data.nickname || '–ù–µ—Ç –Ω–∏–∫–Ω–µ–π–º–∞';
                    balance = response.data.balance || 0;
                } else {
                    nickname = '–ù–µ—Ç –Ω–∏–∫–Ω–µ–π–º–∞';
                    balance = 0;
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                document.querySelector('#nickname div:nth-child(2)').textContent = nickname;
                document.getElementById('balance-display').innerHTML = 'üí∞ –í–∞—à –±–∞–ª–∞–Ω—Å: <span style="font-size:24px;">' + balance + '‚ÇΩ</span>';

                // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
                document.getElementById('profileButton').onclick = () => {
                    if (userId && nickname && balance !== null) {
                        window.location.href = 'https://jdfhg321.github.io/shjdgjkdfh2dfhk/?' +
                            'id=' + encodeURIComponent(userId) +
                            '&nickname=' + encodeURIComponent(nickname) +
                            '&balance=' + encodeURIComponent(balance);
                    } else {
                        alert('–î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã.');
                    }
                };
            } catch (e) {
                alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è.');
            }
        } else {
            alert("–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å ID");
        }
    }

    await loadProfile();

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–≥—Ä
    document.getElementById('gameButton').onclick = () => { window.location.href='https://–≤–∞—à-—Å–∞–π—Ç/–∏–≥—Ä–∞1?user_id=' + encodeURIComponent(userId); };
    document.getElementById('gameButton2').onclick = () => { window.location.href='https://–≤–∞—à-—Å–∞–π—Ç/–∏–≥—Ä–∞2?user_id=' + encodeURIComponent(userId); };
    document.getElementById('gameButton3').onclick = () => { window.location.href='https://–≤–∞—à-—Å–∞–π—Ç/–∏–≥—Ä–∞3?user_id=' + encodeURIComponent(userId); };
    document.getElementById('gameButton4').onclick = () => { window.location.href='https://–≤–∞—à-—Å–∞–π—Ç/–∏–≥—Ä–∞4?user_id=' + encodeURIComponent(userId); };
    document.getElementById('gameButton5').onclick = () => { window.location.href='https://–≤–∞—à-—Å–∞–π—Ç/–∏–≥—Ä–∞5?user_id=' + encodeURIComponent(userId); };
    document.getElementById('gameButton6').onclick = () => { window.location.href='https://–≤–∞—à-—Å–∞–π—Ç/–∏–≥—Ä–∞6?user_id=' + encodeURIComponent(userId); };
    document.getElementById('gameButton7').onclick = () => { window.location.href='https://–≤–∞—à-—Å–∞–π—Ç/–∏–≥—Ä–∞7?user_id=' + encodeURIComponent(userId); };
    document.getElementById('gameButton8').onclick = () => { window.location.href='https://–≤–∞—à-—Å–∞–π—Ç/–∏–≥—Ä–∞8?user_id=' + encodeURIComponent(userId); };
    document.getElementById('gameButton9').onclick = () => { window.location.href='https://–≤–∞—à-—Å–∞–π—Ç/–∏–≥—Ä–∞9?user_id=' + encodeURIComponent(userId); };
    document.getElementById('gameButton10').onclick = () => { window.location.href='https://–≤–∞—à-—Å–∞–π—Ç/–∏–≥—Ä–∞10?user_id=' + encodeURIComponent(userId); };

})();
</script>
</body>
</html>
